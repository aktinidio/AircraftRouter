import java.awt.*;
import java.awt.event.*;
import java.awt.geom.*;
import java.io.*;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

import routing.Router;

@SuppressWarnings("serial")
public class Graph extends JComponent implements MouseWheelListener, Runnable {
	
	private final List<Node> nodes = new ArrayList<Node>();
	private final int[] x = new int[] //{174, 197, 193, 196, 191, 188, 186, 183, 179, 170, 163, 170, 156, 139, 136, 181, 177, 174, 170, 179, 184, 189, 192, 204, 97, 228, 100, 242, 239, 52, 50, 71, 74, 85, 93, 95, 102, 103, 106, 50, 65, 108, 111, 114, 115, 117, 127, 128, 130, 131, 134, 136, 140, 142, 144, 147, 151, 151, 156, 160, 174, 188, 183, 179, 173, 170, 167, 166, 162, 159, 156, 153, 150, 148, 146, 145, 144, 136, 138, 133, 132, 140, 131, 142, 122, 91, 90, 91, 100, 124, 123, 120, 123, 112, 112, 169, 153, 132, 121, 100, 108, 125, 138, 163, 157, 138, 174, 162, 155, 135, 126, 142, 163, 197, 127, 131, 138, 149, 157, 134, 141, 182, 156, 168, 177, 224, 214, 235, 228, 215, 219, 207, 185, 180, 188, 174, 188, 177, 173, 155, 146, 165, 204, 195, 153, 154, 176, 197, 201, 191, 208, 211, 216, 219, 185, 214, 212, 208, 204, 196, 201, 192, 188, 184, 178, 170, 176, 173, 166, 165, 155, 144, 135, 168, 173, 152, 158, 163, 172, 181, 188, 174, 181, 166, 175, 157, 166, 137, 184, 213, 209, 202, 194, 207, 201, 193, 184, 176, 215, 210, 192, 209, 202, 204, 219, 223, 215, 222, 231, 227, 224, 235, 251, 218, 211, 180, 178, 189, 188, 198, 196, 203, 225, 235, 239, 250, 247, 240, 232, 245, 242, 255, 252, 246, 202, 193, 187, 148, 152, 163, 162, 165, 169, 174, 191, 197, 186, 180, 171, 323, 159, 341, 154, 358, 376, 394, 412, 429, 305, 287, 277, 257, 268, 197, 445, 213, 461, 473, 476, 485, 498, 506, 513, 516, 530, 559, 557, 526, 210, 221, 235, 247, 260, 273, 209, 222, 235, 248, 259, 261, 265, 239, 243, 143, 139, 129, 142, 138, 128, 141, 135, 127, 124, 115, 105, 133, 140, 138, 123, 121, 120, 119, 117, 116, 115, 113, 110, 104, 99, 91, 123, 116, 115, 114, 113, 111, 110, 109, 107, 138, 124, 112, 106, 234, 225, 231, 228, 220, 211, 203, 202, 240, 242, 194, 216, 232, 243, 251, 252, 257, 255, 271, 268, 252, 264, 255, 247, 239, 250, 400, 385, 397, 382, 395, 380, 392, 376, 389, 374, 372, 386, 372, 383, 392, 303, 389, 387, 385, 377, 355, 339, 323, 280, 264, 259, 276, 297, 320, 335, 372, 389, 412, 459, 478, 484, 494, 474, 480, 518, 519, 518, 476, 463, 437, 499, 472, 489, 627, 484, 620, 614, 494, 621, 584, 508, 575, 572, 503, 513, 580, 585, 555, 538, 520, 571, 596, 620, 564, 643, 558, 667, 553, 691, 604, 616, 715, 738, 567, 568, 575, 516, 515, 526, 513, 524, 511, 522, 505, 503, 436, 428, 429, 428, 431, 432, 433, 435, 439, 454, 450, 448, 422, 421, 416, 393, 426, 226, 224, 382, 383, 322, 344, 343, 322, 343, 320, 318, 341, 340, 317, 333, 329, 327, 332, 309, 288, 309, 287, 307, 286, 306, 284, 305, 284, 304, 282, 303, 282, 301, 280, 299, 278, 298, 277, 275, 271, 462, 448, 428, 398, 388, 361, 343, 329, 322, 289, 271, 269, 483, 478, 273, 474, 469, 464, 459, 455, 79, 85, 77, 101, 257, 515, 545, 521, 543, 531, 526, 538, 527, 492, 510, 504, 497, 488, 450, 452, 481, 470, 499, 509, 459, 446, 468, 442, 501, 485, 438, 449, 434, 472, 455, 452, 447, 441, 460, 473, 461, 445, 436, 431, 432, 427, 94, 131, 125, 145, 162, 86, 88, 96, 130, 107, 109, 132, 161, 96, 144, 59, 104, 476, 519, 495, 542, 516, 463, 450, 443, 437, 297, 409, 164, 779, 790, 789, 776, 762, 272, 288, 304, 320, 335, 351, 367, 383, 398, 414, 430, 446, 461, 477, 493, 449, 459, 468, 478, 491, 483, 487, 491, 496, 500, 504, 507, 330, 355, 414, 430, 260, 274, 440, 394, 407, 421, 434, 447, 460, 473, 385, 399, 416, 425, 438, 451, 465, 466, 449, 436, 424, 411, 447, 434, 421, 221, 219, 423, 439, 409}
									//{174, 197, 193, 196, 191, 188, 186, 183, 179, 170, 163, 170, 156, 139, 136, 181, 177, 174, 170, 179, 184, 189, 192, 204, 97, 228, 100, 242, 239, 52, 50, 71, 74, 85, 93, 95, 102, 103, 106, 50, 65, 108, 111, 114, 115, 117, 127, 128, 130, 131, 134, 136, 140, 142, 144, 147, 151, 151, 156, 160, 174, 188, 183, 179, 173, 170, 167, 166, 162, 159, 156, 153, 150, 148, 146, 145, 144, 136, 138, 133, 132, 140, 131, 142, 122, 91, 90, 91, 100, 124, 123, 120, 123, 112, 112, 169, 153, 132, 121, 100, 108, 125, 138, 163, 157, 138, 174, 162, 155, 135, 126, 142, 163, 197, 127, 131, 138, 149, 157, 134, 141, 182, 156, 168, 177, 224, 214, 235, 228, 215, 219, 207, 185, 180, 188, 174, 188, 177, 173, 155, 146, 165, 204, 195, 153, 154, 176, 197, 201, 191, 208, 211, 216, 219, 185, 214, 212, 208, 204, 196, 201, 192, 188, 184, 178, 170, 176, 173, 166, 165, 155, 144, 135, 168, 173, 152, 158, 163, 172, 181, 188, 174, 181, 166, 175, 157, 166, 137, 184, 213, 209, 202, 194, 207, 201, 193, 184, 176, 215, 210, 192, 209, 202, 204, 219, 223, 215, 222, 231, 227, 224, 235, 251, 218, 211, 180, 178, 189, 188, 198, 196, 203, 225, 235, 239, 250, 247, 240, 232, 245, 242, 255, 252, 246, 202, 193, 187, 148, 152, 163, 162, 165, 169, 174, 191, 197, 186, 180, 171, 323, 159, 341, 154, 358, 376, 394, 412, 429, 305, 287, 277, 262, 268, 197, 445, 213, 461, 473, 476, 485, 498, 506, 513, 516, 530, 559, 557, 526, 210, 221, 235, 247, 260, 273, 209, 222, 235, 248, 259, 261, 265, 239, 243, 143, 139, 129, 142, 138, 128, 141, 135, 127, 124, 115, 105, 133, 140, 138, 123, 121, 120, 119, 117, 116, 115, 113, 110, 104, 99, 91, 123, 116, 115, 114, 113, 111, 110, 109, 107, 138, 124, 112, 106, 234, 225, 231, 228, 220, 211, 203, 202, 240, 242, 194, 216, 232, 243, 251, 252, 257, 255, 271, 268, 252, 264, 255, 247, 239, 250, 400, 385, 397, 382, 395, 380, 392, 376, 389, 374, 372, 386, 372, 383, 392, 303, 389, 387, 385, 377, 355, 339, 323, 280, 264, 259, 276, 297, 320, 335, 372, 389, 412, 459, 478, 484, 494, 474, 480, 518, 519, 518, 476, 463, 437, 499, 472, 489, 627, 484, 620, 614, 494, 621, 584, 508, 575, 572, 503, 513, 580, 585, 555, 538, 520, 571, 596, 620, 564, 643, 558, 667, 553, 691, 604, 616, 715, 738, 567, 568, 575, 516, 515, 526, 513, 524, 511, 522, 505, 503, 436, 428, 429, 428, 431, 432, 433, 435, 439, 454, 450, 448, 422, 421, 416, 393, 426, 226, 224, 382, 383, 322, 344, 343, 322, 343, 320, 318, 341, 340, 317, 333, 329, 327, 332, 309, 288, 309, 287, 307, 286, 306, 284, 305, 284, 304, 282, 303, 282, 301, 280, 299, 278, 298, 277, 275, 271, 462, 448, 428, 398, 388, 361, 343, 329, 322, 289, 271, 269, 483, 478, 273, 474, 469, 464, 459, 455, 79, 85, 77, 101, 257, 515, 545, 521, 543, 531, 526, 538, 527, 492, 510, 504, 497, 488, 450, 452, 481, 470, 499, 510, 459, 446, 468, 442, 501, 485, 438, 449, 434, 472, 455, 452, 447, 441, 460, 473, 461, 445, 436, 431, 432, 427, 94, 131, 125, 145, 162, 86, 88, 96, 130, 107, 109, 132, 161, 96, 144, 59, 104, 476, 513, 495, 542, 516, 463, 450, 443, 437, 297, 409, 164, 779, 790, 789, 776, 762}
									{531, 580, 526, 574, 515, 561, 503, 554, 498, 526, 518, 511, 505, 558, 548, 540, 491, 544, 531, 515, 500, 586, 582, 592, 599, 592, 604, 604, 612, 607, 617, 536, 541, 543, 546, 548, 560, 556, 564, 568, 562, 571, 576, 572, 580, 585, 582, 589, 531, 524, 524, 519, 515, 510, 508, 492, 494, 486, 485, 478, 477, 469, 467, 460, 461, 454, 454, 447, 448, 443, 443, 439, 435, 431, 427, 424, 416, 414, 415, 685, 674, 663, 651, 641, 632, 764, 764, 706, 770, 585, 584, 570, 562, 553, 545, 520, 475, 505, 490, 493, 505, 481, 518, 469, 627, 644, 636, 658, 648, 646, 651, 644, 636, 628, 615, 603, 603, 585, 575, 472, 487, 501, 510, 519, 532, 544, 554, 563, 574, 588, 599, 611, 620, 629, 514, 529, 544, 491, 481, 481, 482, 476, 469, 465, 460, 454, 449, 454, 469, 480, 491, 504, 515, 526, 534, 532, 533, 547, 560, 572, 589, 602, 612, 537, 550, 556, 561, 566, 569, 573, 578, 583, 590, 594, 601, 616, 630, 641, 650, 657, 664, 666, 652, 639, 627, 611, 596, 581, 574, 567, 560, 554, 547, 537, 537, 530, 523, 515, 522, 523, 542, 522, 507, 499, 492, 485, 480, 514, 508, 500, 493, 471, 465, 444, 406, 386, 366, 341, 313, 290, 268, 247, 221, 197, 455, 449, 445, 450, 439, 432, 426, 420, 445, 433, 538, 644, 655, 673, 689, 705, 719, 724, 726, 627, 637, 646, 659, 671, 684, 698, 711, 722, 723, 428, 404, 411, 397, 384, 372, 320, 300, 282, 259, 239, 221, 368, 380, 392, 386, 397, 412, 417, 422, 437, 425, 453, 471, 484, 504, 520, 541, 545, 565, 581, 606, 604, 631, 649, 671, 689, 706, 721, 727, 437, 451, 467, 480, 491, 504, 515, 529, 549, 559, 577, 594, 609, 624, 553, 575, 594, 613, 554, 571, 587, 601, 555, 555, 566, 579, 591, 611, 635, 610, 620, 508, 514, 524, 538, 548, 556, 551, 554, 532, 509, 485, 464, 443, 427, 410, 392, 384, 392, 398, 403, 377, 371, 362, 357, 350, 341, 331, 324, 313, 304, 294, 288, 275, 262, 251, 241, 230, 222, 212, 203, 181, 251, 266, 304, 317, 324, 331, 338, 347, 353, 361, 355, 364, 375, 368, 365, 359, 351, 346, 340, 355, 364, 370, 306, 374, 386, 398, 397, 755, 734, 748, 732, 767, 751, 735, 193, 160, 728, 630, 502, 355, 374, 365, 197, 337, 359, 233, 309, 353, 429, 482, 407, 414, 434, 439, 502, 548, 613, 535, 191}
									//{0, 20, 25, 49, 70, 76, 102, 133, 128, 152, 178, 199, 212, 236, 234, 238, 257, 271, 285, 244, 270, 252, 289, 287, 292, 318, 294, 296, 304, 317, 335, 340, 355, 360, 351, 377, 374, 335, 308, 401, 386, 405, 423, 423, 424, 442, 458, 474, 490, 512, 495, 477, 520, 492, 505, 519, 535, 535, 397, 397, 397, 396, 413, 412, 413, 415, 556, 575, 592, 603, 630, 630, 602, 612, 648, 673, 332, 317, 335, 337, 339, 341, 298, 300, 283, 265, 263, 302, 314, 283, 256, 238, 230, 211, 246, 280, 280, 265, 299, 313, 330, 347, 266, 252, 238, 223, 209, 193, 169, 148, 147, 165, 181, 197}
					  , y = new int[] //{222, 94, 120, 83, 67, 146, 54, 171, 50, 52, 62, 211, 207, 204, 212, 288, 272, 258, 244, 197, 298, 308, 314, 335, 650, 373, 635, 368, 358, 673, 684, 698, 694, 681, 673, 662, 621, 615, 600, 695, 701, 586, 570, 558, 552, 541, 487, 479, 469, 462, 448, 433, 412, 404, 389, 373, 353, 330, 324, 320, 305, 329, 334, 340, 350, 358, 366, 374, 395, 410, 430, 442, 463, 474, 484, 490, 495, 538, 526, 554, 561, 515, 568, 504, 564, 460, 465, 498, 516, 500, 511, 524, 404, 376, 343, 239, 235, 261, 292, 408, 380, 358, 344, 478, 477, 472, 591, 585, 582, 571, 546, 340, 346, 321, 415, 420, 422, 422, 421, 550, 553, 575, 562, 568, 572, 386, 355, 347, 340, 386, 365, 362, 354, 380, 386, 388, 395, 397, 421, 383, 380, 272, 384, 379, 343, 336, 421, 420, 402, 403, 420, 404, 420, 405, 421, 448, 432, 452, 434, 434, 455, 454, 434, 453, 434, 435, 452, 457, 455, 435, 435, 441, 440, 421, 462, 486, 487, 489, 492, 510, 496, 509, 494, 507, 482, 505, 479, 482, 485, 486, 496, 492, 488, 479, 474, 472, 470, 467, 555, 560, 581, 548, 555, 587, 566, 560, 593, 605, 566, 572, 618, 624, 632, 614, 611, 595, 582, 620, 599, 625, 603, 607, 598, 577, 570, 574, 582, 602, 601, 572, 579, 575, 584, 602, 540, 548, 553, 578, 570, 565, 551, 547, 540, 533, 524, 532, 539, 543, 520, 620, 517, 609, 529, 598, 586, 575, 564, 552, 631, 642, 642, 635, 641, 653, 542, 622, 532, 524, 545, 517, 505, 489, 451, 433, 425, 449, 462, 445, 630, 637, 644, 651, 657, 665, 661, 668, 675, 682, 675, 688, 648, 636, 628, 598, 592, 575, 604, 597, 583, 609, 601, 589, 601, 609, 607, 610, 619, 621, 628, 635, 643, 650, 657, 664, 672, 679, 694, 697, 698, 696, 610, 627, 634, 642, 649, 656, 663, 671, 678, 634, 618, 685, 685, 333, 324, 314, 306, 309, 313, 317, 332, 330, 318, 295, 289, 285, 282, 280, 288, 307, 352, 346, 335, 340, 316, 298, 300, 302, 332, 353, 343, 341, 332, 329, 320, 318, 309, 306, 297, 287, 295, 286, 283, 294, 286, 356, 278, 265, 267, 273, 277, 281, 292, 296, 278, 274, 268, 262, 258, 249, 245, 239, 227, 222, 220, 218, 236, 256, 400, 411, 422, 242, 245, 252, 328, 224, 292, 221, 274, 205, 207, 310, 223, 214, 364, 209, 198, 346, 382, 234, 233, 203, 207, 211, 218, 192, 186, 219, 180, 242, 174, 225, 168, 227, 224, 162, 156, 231, 237, 228, 270, 265, 263, 258, 255, 250, 248, 224, 216, 233, 244, 254, 264, 274, 281, 286, 292, 307, 303, 288, 277, 279, 271, 257, 263, 236, 296, 287, 247, 256, 346, 335, 332, 344, 330, 338, 329, 322, 315, 327, 287, 269, 261, 279, 351, 352, 349, 350, 340, 344, 333, 337, 331, 335, 325, 330, 323, 328, 315, 320, 307, 311, 304, 308, 301, 284, 185, 190, 199, 227, 238, 265, 215, 219, 222, 253, 271, 275, 618, 644, 293, 670, 696, 722, 747, 773, 540, 543, 536, 546, 314, 442, 428, 474, 539, 504, 490, 426, 628, 567, 580, 563, 542, 593, 799, 548, 565, 555, 526, 473, 810, 821, 806, 844, 769, 856, 866, 898, 889, 931, 940, 934, 923, 910, 885, 926, 940, 938, 937, 906, 932, 923, 545, 280, 270, 315, 294, 486, 477, 469, 432, 548, 534, 411, 234, 508, 246, 700, 526, 797, 604, 514, 448, 482, 811, 807, 900, 899, 246, 217, 385, 104, 113, 124, 137, 150, 625, 615, 604, 594, 584, 574, 564, 554, 544, 534, 524, 513, 503, 493, 483, 314, 321, 327, 334, 340, 350, 367, 383, 400, 416, 433, 400, 602, 586, 548, 538, 606, 611, 502, 515, 507, 499, 490, 482, 474, 465, 498, 490, 479, 474, 465, 457, 448, 615, 611, 608, 606, 603, 629, 626, 624, 445, 492, 283, 592, 484}
							  		//{222, 94, 120, 83, 67, 146, 54, 171, 50, 52, 62, 211, 207, 204, 212, 288, 272, 258, 244, 197, 298, 308, 314, 335, 650, 373, 635, 368, 358, 673, 684, 698, 694, 681, 673, 662, 621, 615, 600, 695, 701, 586, 570, 558, 552, 541, 487, 479, 469, 462, 448, 433, 412, 404, 389, 373, 353, 330, 324, 320, 305, 329, 334, 340, 350, 358, 366, 374, 395, 410, 430, 442, 463, 474, 484, 490, 495, 538, 526, 554, 561, 515, 568, 504, 564, 460, 465, 498, 516, 500, 511, 524, 404, 376, 343, 239, 235, 261, 292, 408, 380, 358, 344, 478, 477, 472, 591, 585, 582, 571, 546, 340, 346, 321, 415, 420, 422, 422, 421, 550, 553, 575, 562, 568, 572, 386, 355, 347, 340, 386, 365, 362, 354, 380, 386, 388, 395, 397, 421, 383, 380, 272, 384, 379, 343, 336, 421, 420, 402, 403, 420, 404, 420, 405, 421, 448, 432, 452, 434, 434, 455, 454, 434, 453, 434, 435, 452, 457, 455, 435, 435, 441, 440, 421, 462, 486, 487, 489, 492, 510, 496, 509, 494, 507, 482, 505, 479, 482, 485, 486, 496, 492, 488, 479, 474, 472, 470, 467, 555, 560, 581, 548, 555, 587, 566, 560, 593, 605, 566, 572, 618, 624, 632, 614, 611, 595, 582, 620, 599, 625, 603, 607, 598, 577, 570, 574, 582, 602, 601, 572, 579, 575, 584, 602, 540, 548, 553, 578, 570, 565, 551, 547, 540, 533, 524, 532, 539, 543, 520, 620, 517, 609, 529, 598, 586, 575, 564, 552, 631, 642, 642, 638, 641, 653, 542, 622, 532, 524, 545, 517, 505, 489, 451, 433, 425, 449, 462, 445, 630, 637, 644, 651, 657, 665, 661, 668, 675, 682, 675, 688, 648, 636, 628, 598, 592, 575, 604, 597, 583, 609, 601, 589, 601, 609, 607, 610, 619, 621, 628, 635, 643, 650, 657, 664, 672, 679, 694, 697, 698, 696, 610, 627, 634, 642, 649, 656, 663, 671, 678, 634, 618, 685, 685, 333, 324, 314, 306, 309, 313, 317, 332, 330, 318, 295, 289, 285, 282, 280, 288, 307, 352, 346, 335, 340, 316, 298, 300, 302, 332, 353, 343, 341, 332, 329, 320, 318, 309, 306, 297, 287, 295, 286, 283, 294, 286, 356, 278, 265, 267, 273, 277, 281, 292, 296, 278, 274, 268, 262, 258, 249, 245, 239, 227, 222, 220, 218, 236, 256, 400, 411, 422, 242, 245, 252, 328, 224, 292, 221, 274, 205, 207, 310, 223, 214, 364, 209, 198, 346, 382, 234, 233, 203, 207, 211, 218, 192, 186, 219, 180, 242, 174, 225, 168, 227, 224, 162, 156, 231, 237, 228, 270, 265, 263, 258, 255, 250, 248, 224, 216, 233, 244, 254, 264, 274, 281, 286, 292, 307, 303, 288, 277, 279, 271, 257, 263, 236, 296, 287, 247, 256, 346, 335, 332, 344, 330, 338, 329, 322, 315, 327, 287, 269, 261, 279, 351, 352, 349, 350, 340, 344, 333, 337, 331, 335, 325, 330, 323, 328, 315, 320, 307, 311, 304, 308, 301, 284, 185, 190, 199, 227, 238, 265, 215, 219, 222, 253, 271, 275, 618, 644, 293, 670, 696, 722, 747, 773, 540, 543, 536, 546, 314, 442, 428, 474, 539, 504, 490, 426, 628, 567, 580, 563, 542, 593, 799, 548, 565, 555, 526, 468, 810, 821, 806, 844, 769, 856, 866, 898, 889, 931, 940, 934, 923, 910, 885, 926, 940, 938, 937, 906, 932, 923, 545, 280, 270, 315, 294, 486, 477, 469, 432, 548, 534, 411, 234, 508, 246, 700, 526, 797, 587, 514, 448, 482, 811, 807, 900, 899, 246, 217, 385, 104, 113, 124, 137, 150}
							  		{553, 538, 552, 538, 551, 536, 551, 536, 550, 534, 534, 533, 532, 556, 554, 535, 531, 586, 585, 584, 589, 680, 688, 690, 697, 705, 705, 716, 721, 730, 732, 663, 666, 672, 677, 682, 704, 710, 710, 718, 725, 727, 737, 745, 746, 755, 761, 765, 361, 383, 359, 383, 360, 382, 358, 381, 358, 380, 357, 378, 356, 378, 355, 377, 354, 376, 353, 376, 353, 378, 353, 375, 351, 374, 352, 374, 365, 359, 353, 509, 508, 506, 505, 505, 504, 527, 505, 507, 443, 497, 506, 506, 505, 504, 504, 501, 489, 500, 490, 499, 491, 498, 493, 497, 726, 722, 721, 716, 716, 750, 760, 767, 773, 776, 779, 784, 816, 813, 805, 509, 511, 512, 512, 513, 513, 515, 516, 517, 517, 519, 514, 505, 499, 490, 572, 573, 574, 570, 565, 574, 552, 539, 528, 518, 508, 493, 482, 474, 476, 476, 477, 479, 480, 481, 481, 504, 492, 483, 483, 485, 485, 487, 488, 648, 648, 661, 668, 678, 688, 698, 708, 721, 730, 740, 752, 751, 743, 739, 736, 746, 757, 769, 780, 789, 796, 802, 802, 793, 780, 764, 750, 736, 721, 721, 705, 690, 675, 662, 654, 639, 639, 731, 645, 627, 613, 602, 588, 626, 613, 600, 589, 571, 558, 546, 533, 526, 519, 512, 502, 494, 489, 482, 473, 465, 538, 527, 517, 508, 505, 491, 479, 466, 472, 472, 449, 491, 492, 494, 495, 497, 497, 492, 482, 506, 510, 510, 511, 512, 513, 515, 517, 515, 501, 433, 433, 419, 419, 417, 416, 411, 410, 408, 405, 404, 402, 390, 400, 409, 396, 396, 397, 409, 421, 422, 400, 423, 425, 424, 427, 429, 431, 421, 433, 435, 436, 462, 439, 440, 442, 444, 446, 448, 458, 401, 401, 403, 404, 406, 406, 406, 408, 410, 412, 413, 414, 416, 416, 399, 402, 403, 405, 388, 391, 391, 393, 375, 361, 358, 368, 381, 380, 428, 392, 370, 278, 299, 312, 326, 337, 347, 315, 328, 339, 337, 335, 333, 331, 330, 329, 326, 339, 355, 370, 383, 381, 365, 348, 334, 319, 303, 284, 268, 247, 229, 204, 188, 163, 135, 113, 92, 70, 52, 33, 13, 13, 152, 160, 204, 212, 218, 235, 249, 263, 280, 293, 308, 325, 325, 307, 278, 265, 252, 239, 229, 237, 252, 264, 216, 466, 491, 515, 444, 516, 507, 502, 497, 453, 454, 453, 426, 23, 474, 361, 728, 427, 443, 448, 405, 412, 416, 160, 289, 382, 539, 655, 441, 452, 444, 454, 253, 298, 359, 466, 440}
							  		//{0, 726, 696, 673, 678, 651, 625, 620, 601, 580, 558, 542, 531, 530, 512, 485, 488, 472, 459, 454, 422, 439, 406, 432, 380, 383, 360, 342, 439, 425, 408, 381, 404, 384, 425, 404, 428, 438, 459, 384, 364, 364, 366, 386, 348, 351, 342, 330, 345, 325, 313, 305, 268, 291, 279, 298, 285, 260, 339, 318, 298, 279, 278, 296, 314, 334, 268, 252, 238, 211, 219, 202, 254, 245, 206, 200, 359, 341, 334, 315, 295, 273, 326, 305, 285, 267, 234, 283, 261, 253, 207, 210, 183, 182, 167, 151, 169, 185, 171, 180, 187, 193, 133, 119, 104, 88, 72, 58, 79, 101, 119, 137, 154, 169}
					 , sn = new int[] //{1, 3, 5, 7, 15, 9, 10, 11, 12, 16, 103, 101, 99, 97, 95, 94, 93, 92, 91, 90, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 13, 14, 0, 2, 4, 6, 8, 17, 18, 19, 136, 135, 134, 137, 140, 141, 142, 143, 144, 147, 148, 149, 150, 151, 152, 153, 154, 157, 158, 159, 160, 161, 162, 162, 89, 124, 155, 156, 102, 100, 98, 96, 199, 200, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 194, 195, 196, 198, 196, 197, 198, 163, 163, 165, 165, 166, 166, 169, 170, 170, 171, 172, 173, 174, 174, 192, 194, 193, 201, 414, 197, 202, 203, 204, 205, 206, 139, 138, 139, 137, 137, 210, 209, 208, 203, 203, 199, 199, 199, 203, 399, 423, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 413, 213, 212, 211, 212, 211, 212, 213, 224, 224, 225, 226, 227, 144, 226, 228, 228, 229, 230, 231, 230, 231, 233, 232, 232, 154, 133, 235, 236, 237, 238, 239, 240, 241, 242, 132, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 252, 84, 83, 82, 81, 80, 79, 418, 417, 416, 399, 407, 264, 263, 262, 261, 260, 259, 408, 409, 258, 257, 256, 254, 404, 412, 265, 266, 267, 255, 272, 254, 255, 271, 253, 273, 272, 271, 256, 257, 267, 265, 268, 268, 269, 270, 401, 292, 291, 290, 289, 288, 287, 286, 283, 283, 282, 279, 279, 278, 277, 276, 275, 280, 274, 293, 294, 295, 277, 277, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 281, 301, 307, 308, 309, 307, 311, 312, 313, 311, 315, 316, 317, 318, 319, 314, 310, 306, 321, 310, 314, 319, 322, 320, 323, 320, 269, 270, 343, 342, 341, 340, 339, 338, 337, 336, 335, 334, 333, 332, 328, 329, 317, 329, 331, 330, 328, 328, 327, 326, 325, 324, 332, 400, 364, 363, 362, 361, 360, 359, 358, 357, 356, 355, 354, 353, 352, 351, 350, 349, 348, 347, 346, 345, 344, 344, 411, 410, 365, 366, 347, 376, 377, 377, 376, 348, 373, 372, 371, 370, 367, 353, 369, 383, 382, 381, 380, 378, 379, 386, 385, 384, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75, 76, 77, 78, 74, 72, 68, 70, 66, 64, 62, 60, 58, 56, 54, 52, 50, 48, 143, 284, 305, 405, 391, 391, 406, 388, 389, 390, 87, 85, 392, 393, 86, 394, 395, 20, 169, 171, 173, 174, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 31, 32, 33, 34, 35, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 88, 396, 397, 398, 398}
							 		//{0, 0, 0, 1, 1, 2, 3, 4, 5, 7, 6, 8, 9, 11, 12, 14, 15, 15, 16, 17, 18, 20, 20, 20, 21, 22, 23, 23, 23, 24, 24, 25, 25, 25, 26, 28, 29, 30, 31, 31, 32, 32, 33, 33, 34, 36, 37, 38, 39, 40, 41, 42, 42, 43, 43, 44, 44, 44, 45, 45, 45, 45, 46, 47, 47, 48, 48, 49, 50, 51, 52, 52, 53, 53, 54, 55, 56, 57, 57, 57, 58, 58, 58, 58, 59, 61, 62, 63, 64, 64, 64, 65, 66, 67, 68, 69, 70, 70, 71, 71, 71, 72, 73, 73, 74, 74, 74, 75, 76, 77, 77, 77, 78, 79, 79, 80, 80, 81, 82, 82, 82, 85, 86, 87, 88, 89, 89, 90, 91, 92, 92, 93, 95, 93, 96, 96, 97, 98, 99, 100, 101, 102, 103, 103, 104, 106, 107, 108, 109, 110, 111, 113, 113, 113, 114, 115, 116, 116, 117, 118, 119, 120, 121, 121, 122, 122, 122, 123, 123, 124, 124, 126, 126, 129, 130, 131, 131, 132, 132, 133, 133, 135, 135, 136, 138, 138, 138, 138, 139, 140, 141, 141, 144, 144, 145, 146, 146, 146, 147, 147, 147, 150, 150, 152, 155, 156, 157, 158, 159, 159, 161, 162, 163, 164, 165, 165, 165, 167, 169, 171, 172, 175, 176, 176, 177, 178, 178, 178, 179, 188, 181, 182, 184, 183, 184, 185, 185, 186, 180, 189, 190, 191, 193, 194, 195, 196, 197, 198, 200, 200, 201, 203, 203, 204, 206, 206, 207, 207, 208, 210, 210, 211, 212, 212, 213, 214, 215, 216, 216, 217, 217, 218, 219, 219, 220, 221, 222, 222, 223, 225, 227, 227, 227, 228, 229, 231, 233, 233, 234, 236, 237, 239, 240, 240, 241, 241, 242, 242, 243, 245, 247, 249, 249, 251, 251, 253, 253, 254, 255, 256, 257, 257, 257, 257, 258, 259, 260, 261, 261, 262, 263, 264, 265, 265, 266, 267, 267, 268, 269, 269, 270, 271, 271, 271, 272, 272, 272, 273, 273, 274, 274, 275, 276, 277, 277, 278, 279, 279, 280, 280, 280, 281, 281, 282, 282, 282, 283, 283, 291, 291, 293, 294, 294, 295, 296, 297, 297, 298, 299, 300, 300, 300, 301, 302, 302, 303, 304, 305, 305, 305, 308, 308, 308, 309, 309, 310, 310, 311, 311, 312, 312, 313, 313, 314, 314, 315, 315, 316, 316, 317, 318, 320, 320, 329, 331, 333, 334, 335, 335, 336, 336, 337, 338, 340, 341, 343, 344, 345, 346, 347, 347, 348, 349, 349, 349, 350, 351, 352, 352, 354, 355, 356, 357, 359, 359, 360, 361, 362, 363, 364, 365, 366, 367, 367, 368, 369, 370, 370, 370, 372, 373, 374, 374, 376, 377, 377, 377, 378, 379, 380, 382, 383, 384, 385, 385, 386, 387, 388, 388, 389, 390, 391, 392, 393, 393, 394, 395, 395, 395, 396, 397, 397, 398, 398, 398, 399, 401, 402, 403, 404, 404, 404, 405, 406, 406, 407, 409, 410, 410, 413, 413, 413, 414, 414, 415, 415, 415, 415, 415, 416, 416, 417, 421, 422, 423, 424, 424, 425, 426, 427, 427, 427, 428, 430, 432, 435, 436, 440, 441, 441, 443, 443, 445, 445, 447, 449, 449, 450, 451, 452, 453, 453, 454, 454, 454, 455, 456, 456, 457, 457, 463, 463, 465, 466, 467, 468, 468, 468, 468, 470, 471, 472, 472, 474, 474, 476, 477, 478, 478, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 505, 506, 507, 508, 509, 509, 511, 512, 513, 514, 515, 515, 516, 518, 518, 519, 520, 521, 522, 523, 524, 525, 526, 526, 527, 529, 529, 530, 531, 532, 533, 534, 535, 536, 538, 539, 539, 540, 540, 541, 542, 543, 544, 545, 546, 548, 549, 550, 550, 551, 552, 552, 553, 554, 555, 556, 557, 557, 558, 558, 559, 560, 560, 560, 561, 562, 563, 565, 567, 568, 569, 570, 573, 573, 577, 578, 579, 582, 585, 596, 600, 600, 601, 602, 603, 604, 606, 607, 607, 608, 609, 609, 610, 611, 611, 612, 613, 614, 614, 615, 616, 616, 617, 618, 619, 621, 622, 623, 624, 624, 625, 626, 627, 628, 629, 629, 630, 637}
							 		//{0, 0, 0, 1, 1, 2, 3, 4, 5, 7, 6, 8, 9, 11, 12, 14, 15, 15, 16, 17, 18, 20, 20, 20, 21, 22, 23, 23, 23, 24, 24, 25, 25, 25, 26, 28, 29, 30, 31, 31, 32, 32, 33, 33, 34, 36, 37, 38, 39, 40, 41, 42, 42, 43, 43, 44, 44, 44, 45, 45, 45, 45, 46, 47, 47, 48, 48, 49, 50, 51, 52, 52, 53, 53, 54, 55, 56, 57, 57, 57, 58, 58, 58, 58, 59, 61, 62, 63, 64, 64, 64, 65, 66, 67, 68, 69, 70, 70, 71, 71, 71, 72, 73, 73, 74, 74, 74, 75, 76, 77, 77, 77, 78, 79, 79, 80, 80, 81, 82, 82, 82, 85, 86, 87, 88, 89, 89, 90, 91, 92, 92, 93, 95, 93, 96, 96, 97, 98, 99, 100, 101, 102, 103, 103, 104, 106, 107, 108, 109, 110, 111, 113, 113, 113, 114, 115, 116, 116, 117, 118, 119, 120, 121, 121, 122, 122, 122, 123, 123, 124, 124, 126, 126, 129, 130, 131, 131, 132, 132, 133, 133, 135, 135, 136, 138, 138, 138, 138, 139, 140, 141, 141, 144, 144, 145, 146, 146, 146, 147, 147, 147, 150, 150, 152, 155, 156, 157, 158, 159, 159, 161, 162, 163, 164, 165, 165, 165, 167, 169, 171, 172, 175, 176, 176, 177, 178, 178, 178, 179, 188, 181, 182, 184, 183, 184, 185, 185, 186, 180, 189, 190, 191, 193, 194, 195, 196, 197, 198, 200, 200, 201, 203, 203, 204, 206, 206, 207, 207, 208, 210, 210, 211, 212, 212, 213, 214, 215, 216, 216, 217, 217, 218, 219, 219, 220, 221, 222, 222, 223, 225, 227, 227, 227, 228, 229, 231, 233, 234, 236, 237, 239, 240, 240, 241, 241, 242, 242, 243, 245, 247, 249, 249, 251, 253, 254, 255, 256, 257, 257, 258, 259, 260, 261, 262, 263, 264, 265, 265, 266, 267, 267, 268, 269, 269, 270, 271, 271, 271, 272, 272, 272, 273, 273, 274, 274, 275, 276, 277, 277, 278, 279, 279, 280, 280, 280, 281, 281, 282, 282, 282, 283, 283, 291, 291, 293, 294, 294, 295, 296, 297, 297, 298, 299, 300, 300, 300, 301, 302, 302, 303, 304, 305, 305, 305, 308, 308, 308, 309, 309, 310, 310, 311, 311, 312, 312, 313, 313, 314, 314, 315, 315, 316, 316, 317, 318, 320, 320, 329, 331, 333, 334, 335, 335, 336, 336, 337, 338, 340, 341, 343, 344, 345, 346, 347, 347, 348, 349, 349, 349, 350, 351, 352, 352, 354, 355, 356, 357, 359, 359, 360, 361, 362, 363, 364, 365, 366, 367, 367, 368, 369, 370, 370, 370, 372, 373, 374, 374, 376, 377, 377, 377, 378, 379, 380, 382, 383, 384, 385, 385, 386, 387, 388, 388, 389, 390, 391, 392, 393, 393, 394, 395, 395, 395, 396, 397, 397, 398, 398, 399, 401, 402, 403, 404, 404, 405, 406, 406, 407, 409, 410, 410, 413, 413, 413, 414, 414, 415, 415, 415, 415, 415, 416, 416, 421, 422, 423, 424, 424, 425, 426, 427, 427, 427, 428, 430, 432, 435, 436, 440, 441, 441, 443, 443, 445, 445, 447, 449, 449, 450, 451, 452, 453, 453, 454, 454, 454, 455, 456, 456, 457, 463, 463, 465, 466, 467, 468, 468, 468, 468, 470, 471, 472, 472, 474, 474, 476, 477, 478, 478, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 505, 506, 507, 508, 509, 509, 511, 512, 513, 514, 515, 515, 516, 518, 518, 519, 520, 521, 522, 523, 524, 525, 526, 526, 527, 529, 529, 530, 532, 533, 534, 535, 536, 538, 539, 539, 540, 540, 541, 542, 542, 543, 544, 545, 546, 548, 550, 550, 551, 552, 552, 553, 554, 555, 556, 557, 557, 558, 558, 559, 560, 560, 560, 561, 562, 563, 565, 567, 568, 569, 570, 573, 573, 577, 578, 579, 582, 585, 596, 600, 600, 601, 602, 603, 604}
							 		{1, 3, 5, 7, 15, 9, 10, 11, 12, 16, 103, 101, 99, 97, 95, 94, 93, 92, 91, 90, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 13, 14, 0, 2, 4, 6, 8, 17, 18, 19, 136, 135, 134, 137, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 157, 158, 159, 160, 161, 162, 162, 89, 124, 155, 156, 102, 100, 98, 96, 199, 200, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 194, 195, 196, 198, 196, 197, 198, 163, 163, 165, 165, 166, 166, 169, 170, 170, 171, 172, 173, 174, 174, 192, 194, 193, 201, 414, 197, 202, 203, 204, 205, 206, 139, 138, 139, 137, 137, 210, 209, 208, 203, 203, 199, 199, 199, 203, 399, 423, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 413, 213, 212, 211, 212, 211, 212, 213, 224, 224, 225, 226, 227, 144, 226, 228, 228, 229, 230, 231, 230, 231, 233, 146, 232, 232, 154, 422, 133, 235, 236, 237, 238, 239, 240, 241, 242, 132, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 252, 84, 83, 82, 81, 80, 79, 418, 417, 416, 399, 407, 264, 263, 262, 261, 260, 259, 408, 409, 258, 257, 256, 254, 404, 412, 265, 266, 267, 255, 272, 254, 255, 271, 253, 273, 272, 271, 256, 257, 267, 265, 268, 268, 269, 270, 401, 292, 291, 290, 289, 288, 287, 286, 285, 285, 283, 283, 282, 279, 279, 278, 277, 276, 275, 234, 280, 274, 293, 294, 295, 277, 277, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 281, 301, 307, 308, 309, 307, 311, 312, 313, 311, 315, 316, 317, 318, 319, 314, 310, 306, 321, 310, 314, 319, 322, 320, 323, 320, 269, 270, 343, 342, 341, 340, 339, 338, 337, 336, 335, 334, 333, 332, 328, 329, 317, 329, 331, 330, 328, 328, 327, 326, 325, 324, 332, 400, 364, 363, 362, 361, 360, 359, 358, 357, 356, 355, 354, 353, 352, 351, 350, 349, 348, 347, 346, 345, 344, 344, 411, 410, 365, 366, 347, 376, 377, 377, 376, 348, 375, 374, 373, 372, 371, 370, 369, 368, 367, 353, 387, 369, 383, 382, 381, 380, 379, 374, 378, 379, 386, 385, 384, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75, 76, 77, 78, 74, 72, 68, 70, 66, 64, 62, 60, 58, 56, 54, 52, 50, 48, 143, 284, 305, 405, 391, 391, 406, 388, 389, 390, 87, 85, 392, 393, 86, 394, 395, 20, 169, 171, 173, 174, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 31, 32, 33, 34, 35, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 88, 396, 397, 398, 398}
							 		//{1, 2, 3, 3, 4, 5, 6, 6, 7, 8, 9, 10, 11, 12, 12, 13, 14, 14, 15, 16, 17, 18, 18, 18, 19, 20, 21, 22, 23, 24, 25, 25, 27, 27, 28, 29, 30, 30, 30, 31, 31, 31, 33, 34, 34, 34, 35, 37, 38, 39, 39, 39, 40, 40, 40, 41, 41, 41, 42, 42, 43, 44, 44, 44, 45, 46, 47, 47, 47, 50, 50, 51, 51, 52, 52, 52, 53, 53, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 67, 68, 68, 68, 69, 70, 71, 76, 76, 78, 79, 80, 81, 82, 83, 83, 84, 85, 86, 86, 87, 87, 89, 90, 91, 91, 92, 93, 94, 96, 96, 97, 98, 99, 100, 102, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 26, 77, 32, 32, 32, 82, 32, 41, 53, 54, 55, 74}
	 				 , en = new int[] //{128, 128, 126, 126, 125, 124, 123, 122, 121, 120, 119, 119, 120, 121, 123, 125, 126, 127, 128, 129, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 136, 136, 135, 135, 134, 137, 137, 136, 135, 134, 135, 134, 137, 140, 141, 142, 143, 144, 145, 148, 149, 150, 151, 152, 153, 154, 157, 158, 159, 160, 161, 162, 133, 132, 160, 155, 156, 154, 153, 152, 150, 149, 200, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 194, 195, 196, 198, 199, 197, 198, 163, 164, 31, 32, 33, 34, 35, 36, 38, 39, 41, 42, 44, 45, 47, 193, 193, 201, 403, 202, 202, 203, 204, 205, 206, 139, 138, 140, 137, 138, 210, 209, 208, 207, 207, 208, 202, 163, 207, 199, 423, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 413, 213, 212, 211, 206, 138, 212, 224, 224, 143, 225, 226, 227, 144, 119, 228, 227, 229, 230, 231, 416, 233, 233, 232, 147, 418, 422, 235, 236, 237, 238, 239, 240, 241, 242, 401, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 241, 240, 243, 244, 245, 246, 247, 248, 417, 253, 415, 407, 264, 263, 262, 261, 260, 259, 408, 409, 258, 257, 256, 254, 415, 409, 265, 266, 267, 255, 272, 253, 255, 271, 274, 273, 272, 271, 270, 267, 267, 269, 268, 267, 269, 270, 274, 292, 291, 290, 289, 288, 287, 286, 284, 284, 282, 280, 280, 278, 277, 276, 275, 273, 281, 293, 294, 295, 296, 296, 297, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 301, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 314, 310, 306, 321, 287, 322, 320, 320, 320, 323, 402, 421, 343, 343, 342, 341, 340, 339, 338, 337, 336, 335, 334, 333, 332, 328, 329, 316, 329, 331, 330, 420, 331, 327, 326, 325, 324, 419, 327, 364, 363, 362, 361, 360, 359, 358, 357, 356, 355, 354, 353, 352, 351, 350, 349, 348, 347, 346, 345, 344, 265, 268, 350, 365, 366, 355, 376, 377, 340, 339, 348, 375, 372, 371, 370, 369, 355, 387, 383, 382, 381, 380, 379, 377, 386, 385, 384, 383, 299, 299, 298, 297, 297, 296, 295, 295, 294, 294, 293, 293, 274, 274, 342, 341, 338, 337, 336, 336, 336, 335, 335, 335, 334, 334, 334, 333, 333, 332, 332, 119, 305, 310, 391, 415, 416, 388, 389, 390, 413, 250, 392, 393, 252, 394, 395, 241, 210, 37, 40, 43, 46, 192, 192, 192, 191, 191, 191, 190, 190, 190, 189, 189, 189, 196, 196, 196, 195, 195, 168, 168, 169, 170, 170, 170, 171, 172, 173, 173, 177, 178, 177, 178, 178, 179, 180, 182, 183, 183, 184, 185, 186, 186, 187, 396, 397, 398, 292, 291};
	 						 		//{11, 18, 19, 2, 3, 5, 4, 6, 7, 19, 8, 9, 10, 12, 13, 13, 20, 16, 17, 18, 95, 21, 60, 343, 22, 113, 340, 126, 128, 26, 35, 130, 27, 125, 36, 130, 30, 39, 40, 32, 33, 319, 34, 319, 35, 37, 304, 41, 587, 587, 42, 43, 84, 44, 84, 45, 110, 581, 110, 91, 581, 582, 47, 48, 187, 49, 105, 50, 172, 116, 116, 53, 54, 583, 140, 56, 144, 58, 111, 575, 59, 145, 575, 576, 60, 62, 63, 64, 65, 112, 132, 66, 67, 600, 69, 118, 118, 170, 170, 72, 171, 73, 105, 74, 75, 175, 187, 76, 83, 110, 119, 78, 81, 119, 80, 82, 84, 83, 84, 109, 295, 86, 87, 585, 588, 46, 90, 91, 582, 583, 114, 92, 584, 94, 586, 584, 586, 97, 100, 101, 102, 111, 104, 174, 73, 107, 108, 237, 237, 119, 144, 61, 339, 340, 115, 116, 117, 580, 118, 173, 120, 122, 202, 200, 239, 238, 240, 247, 124, 236, 121, 127, 130, 130, 131, 142, 132, 133, 143, 135, 134, 600, 137, 137, 137, 173, 146, 165, 140, 55, 18, 576, 112, 145, 57, 149, 154, 164, 150, 154, 148, 152, 151, 153, 156, 158, 158, 159, 160, 162, 162, 164, 164, 165, 169, 168, 166, 168, 170, 172, 51, 176, 177, 186, 178, 182, 184, 183, 180, 192, 182, 180, 188, 183, 186, 177, 177, 103, 192, 190, 191, 192, 191, 192, 188, 184, 186, 199, 199, 203, 202, 204, 206, 205, 209, 222, 222, 213, 209, 213, 211, 292, 292, 261, 214, 221, 106, 121, 106, 218, 220, 215, 220, 221, 218, 220, 223, 228, 224, 226, 226, 233, 228, 230, 230, 232, 232, 637, 235, 235, 238, 123, 252, 241, 250, 242, 248, 243, 244, 246, 246, 251, 258, 253, 633, 254, 634, 255, 256, 257, 264, 545, 635, 636, 259, 260, 262, 262, 606, 290, 278, 266, 213, 278, 267, 268, 269, 546, 270, 591, 271, 549, 548, 593, 533, 531, 549, 531, 400, 400, 537, 532, 592, 531, 592, 279, 280, 284, 281, 291, 285, 282, 286, 283, 290, 287, 288, 289, 292, 292, 294, 295, 297, 298, 297, 298, 300, 301, 300, 302, 301, 305, 302, 305, 320, 304, 38, 306, 307, 320, 321, 309, 330, 322, 310, 323, 311, 324, 312, 325, 313, 326, 314, 327, 315, 328, 331, 331, 317, 318, 319, 303, 330, 330, 332, 334, 335, 336, 342, 466, 337, 338, 339, 334, 342, 344, 467, 346, 347, 348, 384, 355, 354, 530, 355, 351, 352, 353, 354, 358, 356, 357, 336, 375, 361, 361, 363, 363, 365, 365, 367, 367, 373, 370, 370, 370, 372, 373, 371, 376, 376, 381, 382, 377, 378, 464, 469, 379, 380, 483, 520, 355, 517, 517, 386, 387, 482, 482, 389, 468, 391, 465, 405, 394, 405, 395, 448, 448, 395, 401, 401, 408, 399, 418, 632, 400, 402, 403, 451, 411, 417, 625, 396, 408, 411, 409, 410, 413, 412, 434, 415, 433, 417, 418, 424, 420, 416, 439, 419, 421, 425, 625, 422, 423, 448, 427, 438, 426, 428, 437, 431, 429, 430, 432, 435, 436, 605, 441, 442, 443, 444, 445, 447, 446, 448, 392, 465, 451, 452, 453, 462, 454, 455, 461, 460, 456, 459, 457, 458, 621, 464, 451, 450, 467, 345, 469, 390, 510, 511, 471, 472, 474, 473, 477, 475, 477, 478, 480, 479, 483, 483, 481, 381, 485, 487, 487, 489, 489, 491, 491, 493, 493, 495, 495, 497, 497, 499, 499, 501, 501, 503, 503, 504, 520, 517, 520, 507, 508, 599, 599, 510, 380, 513, 514, 598, 516, 598, 517, 519, 543, 521, 383, 522, 523, 524, 525, 544, 528, 527, 572, 572, 581, 342, 631, 537, 536, 535, 536, 593, 590, 542, 543, 590, 541, 542, 548, 546, 551, 547, 547, 591, 620, 594, 544, 553, 594, 589, 556, 589, 564, 558, 564, 596, 569, 597, 566, 561, 566, 567, 562, 563, 597, 559, 568, 570, 571, 571, 574, 575, 578, 579, 580, 588, 88, 597, 139, 68, 602, 603, 604, 605, 607, 608, 638, 609, 610, 633, 611, 612, 634, 613, 614, 615, 635, 616, 617, 636, 618, 619, 620, 622, 623, 624, 625, 626, 626, 627, 628, 629, 630, 632, 631, 638};
	 						 		//{11, 18, 19, 2, 3, 5, 4, 6, 7, 19, 8, 9, 10, 12, 13, 13, 20, 16, 17, 18, 95, 21, 60, 343, 22, 113, 340, 126, 128, 26, 35, 130, 27, 125, 36, 130, 30, 39, 40, 32, 33, 319, 34, 319, 35, 37, 304, 41, 587, 587, 42, 43, 84, 44, 84, 45, 110, 581, 110, 91, 581, 582, 47, 48, 187, 49, 105, 50, 172, 116, 116, 53, 54, 583, 140, 56, 144, 58, 111, 575, 59, 145, 575, 576, 60, 62, 63, 64, 65, 112, 132, 66, 67, 600, 69, 118, 118, 170, 170, 72, 171, 73, 105, 74, 75, 175, 187, 76, 83, 110, 119, 78, 81, 119, 80, 82, 84, 83, 84, 109, 295, 86, 87, 585, 588, 46, 90, 91, 582, 583, 114, 92, 584, 94, 586, 584, 586, 97, 100, 101, 102, 111, 104, 174, 73, 107, 108, 237, 237, 119, 144, 61, 339, 340, 115, 116, 117, 580, 118, 173, 120, 122, 202, 200, 239, 238, 240, 247, 124, 236, 121, 127, 130, 130, 131, 142, 132, 133, 143, 135, 134, 600, 137, 137, 137, 173, 146, 165, 140, 55, 18, 576, 112, 145, 57, 149, 154, 164, 150, 154, 148, 152, 151, 153, 156, 158, 158, 159, 160, 162, 162, 164, 164, 165, 169, 168, 166, 168, 170, 172, 51, 176, 177, 186, 178, 182, 184, 183, 180, 192, 182, 180, 188, 183, 186, 177, 177, 103, 192, 190, 191, 192, 191, 192, 188, 184, 186, 199, 199, 203, 202, 204, 206, 205, 209, 222, 222, 213, 209, 213, 211, 292, 292, 261, 214, 221, 106, 121, 106, 218, 220, 215, 220, 221, 218, 220, 223, 228, 224, 226, 226, 233, 228, 230, 230, 232, 232, 235, 235, 238, 123, 252, 241, 250, 242, 248, 243, 244, 246, 246, 251, 258, 253, 254, 255, 256, 257, 264, 545, 259, 260, 262, 262, 290, 278, 266, 213, 278, 267, 268, 269, 546, 270, 591, 271, 549, 548, 593, 533, 531, 549, 531, 400, 400, 537, 532, 592, 531, 592, 279, 280, 284, 281, 291, 285, 282, 286, 283, 290, 287, 288, 289, 292, 292, 294, 295, 297, 298, 297, 298, 300, 301, 300, 302, 301, 305, 302, 305, 320, 304, 38, 306, 307, 320, 321, 309, 330, 322, 310, 323, 311, 324, 312, 325, 313, 326, 314, 327, 315, 328, 331, 331, 317, 318, 319, 303, 330, 330, 332, 334, 335, 336, 342, 466, 337, 338, 339, 334, 342, 344, 467, 346, 347, 348, 384, 355, 354, 530, 355, 351, 352, 353, 354, 358, 356, 357, 336, 375, 361, 361, 363, 363, 365, 365, 367, 367, 373, 370, 370, 370, 372, 373, 371, 376, 376, 381, 382, 377, 378, 464, 469, 379, 380, 483, 520, 355, 517, 517, 386, 387, 482, 482, 389, 468, 391, 465, 405, 394, 405, 395, 448, 448, 395, 401, 401, 408, 399, 418, 400, 402, 403, 451, 411, 417, 396, 408, 411, 409, 410, 413, 412, 434, 415, 433, 417, 418, 424, 420, 416, 439, 419, 421, 425, 422, 423, 448, 427, 438, 426, 428, 437, 431, 429, 430, 432, 435, 436, 605, 441, 442, 443, 444, 445, 447, 446, 448, 392, 465, 451, 452, 453, 462, 454, 455, 461, 460, 456, 459, 457, 458, 464, 451, 450, 467, 345, 469, 390, 510, 511, 471, 472, 474, 473, 477, 475, 477, 478, 480, 479, 483, 483, 481, 381, 485, 487, 487, 489, 489, 491, 491, 493, 493, 495, 495, 497, 497, 499, 499, 501, 501, 503, 503, 504, 520, 517, 520, 507, 508, 599, 599, 510, 380, 513, 514, 598, 516, 598, 517, 519, 543, 521, 383, 522, 523, 524, 525, 544, 528, 527, 572, 572, 581, 342, 537, 536, 535, 536, 593, 590, 542, 543, 590, 541, 542, 543, 548, 546, 551, 547, 547, 591, 594, 544, 553, 594, 589, 556, 589, 564, 558, 564, 596, 569, 597, 566, 561, 566, 567, 562, 563, 597, 559, 568, 570, 571, 571, 574, 575, 578, 579, 580, 588, 88, 597, 139, 68, 602, 603, 604, 605};
	 						 		{128, 128, 126, 126, 125, 124, 123, 122, 121, 120, 119, 119, 120, 121, 123, 125, 126, 127, 128, 129, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 136, 136, 135, 135, 134, 137, 137, 136, 135, 134, 135, 134, 137, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 157, 158, 159, 160, 161, 162, 133, 132, 160, 155, 156, 154, 153, 152, 150, 149, 200, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 194, 195, 196, 198, 199, 197, 198, 163, 164, 31, 32, 33, 34, 35, 36, 38, 39, 41, 42, 44, 45, 47, 193, 193, 201, 403, 202, 202, 203, 204, 205, 206, 139, 138, 140, 137, 138, 210, 209, 208, 207, 207, 208, 202, 163, 207, 199, 423, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 413, 213, 212, 211, 206, 138, 212, 224, 224, 143, 225, 226, 227, 144, 119, 228, 227, 229, 230, 231, 416, 233, 233, 232, 232, 147, 418, 422, 234, 235, 236, 237, 238, 239, 240, 241, 242, 401, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 241, 240, 243, 244, 245, 246, 247, 248, 417, 253, 415, 407, 264, 263, 262, 261, 260, 259, 408, 409, 258, 257, 256, 254, 415, 409, 265, 266, 267, 255, 272, 253, 255, 271, 274, 273, 272, 271, 270, 267, 267, 269, 268, 267, 269, 270, 274, 292, 291, 290, 289, 288, 287, 286, 284, 284, 161, 284, 282, 280, 280, 278, 277, 276, 275, 273, 280, 281, 293, 294, 295, 296, 296, 297, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 301, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 314, 310, 306, 321, 287, 322, 320, 320, 320, 323, 402, 421, 343, 343, 342, 341, 340, 339, 338, 337, 336, 335, 334, 333, 332, 328, 329, 316, 329, 331, 330, 420, 331, 327, 326, 325, 324, 419, 327, 364, 363, 362, 361, 360, 359, 358, 357, 356, 355, 354, 353, 352, 351, 350, 349, 348, 347, 346, 345, 344, 265, 268, 350, 365, 366, 355, 376, 377, 340, 339, 348, 375, 374, 373, 372, 371, 370, 369, 368, 367, 355, 387, 368, 383, 382, 381, 380, 379, 374, 378, 377, 386, 385, 384, 383, 299, 299, 298, 297, 297, 296, 295, 295, 294, 294, 293, 293, 274, 274, 342, 341, 338, 337, 336, 336, 336, 335, 335, 335, 334, 334, 334, 333, 333, 332, 332, 119, 305, 310, 391, 415, 416, 388, 389, 390, 413, 250, 392, 393, 252, 394, 395, 241, 210, 37, 40, 43, 46, 192, 192, 192, 191, 191, 191, 190, 190, 190, 189, 189, 189, 196, 196, 196, 195, 195, 168, 168, 169, 170, 170, 170, 171, 172, 173, 173, 177, 178, 177, 178, 178, 179, 180, 182, 183, 183, 184, 185, 186, 186, 187, 396, 397, 398, 292, 291};
	 						 		//{2, 3, 4, 5, 5, 6, 7, 8, 8, 9, 10, 11, 12, 13, 14, 14, 15, 16, 19, 17, 18, 38, 23, 28, 21, 22, 20, 24, 22, 26, 22, 76, 77, 82, 29, 30, 32, 31, 33, 33, 25, 76, 40, 36, 32, 35, 39, 34, 37, 41, 43, 42, 41, 58, 65, 58, 42, 44, 44, 45, 42, 45, 65, 58, 46, 47, 48, 50, 51, 49, 55, 50, 53, 57, 56, 66, 55, 54, 49, 52, 56, 66, 66, 59, 60, 61, 62, 63, 64, 65, 67, 68, 72, 73, 69, 70, 71, 74, 74, 77, 78, 79, 80, 81, 88, 83, 87, 84, 85, 86, 90, 91, 88, 89, 86, 97, 92, 93, 94, 113, 95, 95, 98, 96, 99, 100, 101, 95, 94, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 27, 78, 35, 33, 36, 77, 31, 43, 50, 49, 49, 75};
					
	int[] p = new int[] { 0 }, nID = new int[3];
	int[][] nodesIDs = new int[2][2];
	double d = 1.0;
	int x1, x2, y1, y2;
	Graphics2D g2;
	Color[] newColor;
	Router router;
	Point point[] = new Point[3];
	AffineTransform tx = new AffineTransform();
	
	public static void main(String args[]) {
		new Graph();
	}
	
	public Graph(){
		JFrame f = new JFrame("Map");
		Container c = f.getContentPane();
		c.setLayout(new BorderLayout());
		c.setBackground(Color.WHITE);
		c.add(this, BorderLayout.CENTER);
		f.setSize(600, 600);
		f.setExtendedState(JFrame.MAXIMIZED_BOTH);
		f.setVisible(true);
		f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		addMouseWheelListener(this);
		addMouseListener(new MyMouseListener(this));
	    addMouseMotionListener(new MyMouseMotionListener(this));
		for (int i = 0; i < 424/*114/*667 /*606 /*424*/; i++)
			nodes.add(new Node(i, x[i], y[i]));
		
		readCoords();

		router = new Router();
		findNode(point[1], 1);
		findNode(point[2], 2);
		p = router.exectue(findNode(point[0], 0), 402, nodesIDs);
		
		new Thread(this).start();
	}

	public void paint(Graphics g) {

		g2 = (Graphics2D) g;
		g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

		for (int i = 0; i < 424/*114/*639 /*606 /*424*/; i++)
			drawOval(x[i], y[i]);

		for (int i = 0; i < 507 /*152/*493/*713/*670 /*507*/; i++)
			drawLine(nodes.get(sn[i]).getX(), nodes.get(sn[i]).getY(), nodes.get(en[i]).getX(), nodes.get(en[i]).getY());
		
//		g2.setStroke(new BasicStroke(1, BasicStroke.CAP_BUTT, BasicStroke.JOIN_BEVEL, 0, new float[] { 2 }, 0));
//		for (int i = 663; i < 713/*670 /*507*/; i++)
//			drawLine(nodes.get(sn[i]).getX(), nodes.get(sn[i]).getY(), nodes.get(en[i]).getX(), nodes.get(en[i]).getY());

		//path
		g2.setStroke(new BasicStroke(s(2)));
		g.setColor(Color.RED);
		drawLine(nodes.get(p[0]).getX(), nodes.get(p[0]).getY(), nodes.get(nID[0]).getX(), nodes.get(nID[0]).getY());
		for (int i = 0; i < p.length - 1; i++)
			drawLine(nodes.get(p[i]).getX(), nodes.get(p[i]).getY(), nodes.get(p[i + 1]).getX(), nodes.get(p[i + 1]).getY());
		

		g.setColor(Color.WHITE);
		for (int i = 0; i < 424/*114/*639/*606 /*424*/; i++)
			fillOval(x[i], y[i]);
		
		for (int i = 0; i < 3; i++){
			if (nID[i] == -1)
				continue;
			g.setColor(newColor[i]);
			fillOval(nodes.get(nID[i]).getX(), nodes.get(nID[i]).getY());
		}
		
		g2.setStroke(new BasicStroke(s(5)));
		g.setColor(Color.BLACK);
		drawLine(160, 23, 502, 728);
		drawLine(193, 426, 728, 474);
		drawLine(630, 361, 228, 0);

		g2.setStroke(new BasicStroke(s(12)));
		g.setColor(Color.BLUE);
		drawLine(427, 363, 531, 372);
		g.setColor(Color.MAGENTA);
		drawLine(491, 540, 580, 547);
		g.setColor(Color.GREEN);
		drawLine(518, 595, 565, 598);
		g.setColor(Color.ORANGE);
		drawLine(760, 443, 780, 444);

		g2.setStroke(new BasicStroke(1, BasicStroke.CAP_BUTT, BasicStroke.JOIN_BEVEL, 0, new float[] { 5 }, 0));
		g2.setColor(Color.WHITE);
		drawLine(160, 23, 502, 728);
		drawLine(193, 426, 728, 474);
		drawLine(630, 361, 228, 0);
	}
	
	private void drawLine(int x1, int y1, int x2, int y2) {
		g2.draw(tx.createTransformedShape(new Line2D.Float(x1, y1, x2, y2)));
	}

	private void drawOval(int x, int y) {
		g2.draw(tx.createTransformedShape(new Ellipse2D.Float(x - 3, y - 3, 6, 6)));
	}

	private void fillOval(double x1, double y1) {
		g2.fill(tx.createTransformedShape(new Ellipse2D.Float((float) (x1 - 2.95), (float) (y1 - 2.95), (float) 5.9, (float) 5.9)));
	}

	private int s(int number) {
		return (int) Math.round(number * d);
	}
	
	private void readCoords() {
		try {
			BufferedReader in = new BufferedReader(new FileReader("input.txt"));
			for (int i = 0; i < 3; i++) {
				double lat = Double.parseDouble(in.readLine());
				double lon = Double.parseDouble(in.readLine());
				point[i] = new Point((int) Math.round((lon - 8.525563) * 16200), (int) Math.round((47.476512 - lat) * 24000));
			}
			in.close();
			newColor = new Color[3];
		} catch (IOException e) {}
	}
	
	private int findNode(Point p, int k) {
		double min = Double.MAX_VALUE;
		Node cNode = null;
		for (int i = 0; i < 507/*152 /*587 /*507*/; i++) {
			double d = distToSegment((int) p.getX(), (int) p.getY(), nodes.get(sn[i]).getX(), nodes.get(sn[i]).getY(), nodes.get(en[i]).getX(), nodes.get(en[i]).getY());
			if (min > d) {
				min = d;
				cNode = (dist2((int) p.getX(), (int) p.getY(), nodes.get(sn[i]).getX(), nodes.get(sn[i]).getY()) < dist2((int) p.getX(), (int) p.getY(), nodes.get(en[i]).getX(), nodes.get(en[i]).getY()) ? nodes.get(sn[i]) : nodes.get(en[i]));
				if (k > 0) {
					nodesIDs[k-1][0] = nodes.get(sn[i]).getID();
					nodesIDs[k-1][1] = nodes.get(en[i]).getID();
				}
			}
		}
		if (min > 100) {
			if (k > 0) {
				nodesIDs[k-1][0] = -1;
				nodesIDs[k-1][1] = -1;
				nID[k] = -1;
			}
			return -1;
		}
		nID[k] = cNode.getID();
		return cNode.getID();
	}
		
	private double sqr(double x) {
		return x * x;
	}

	private double dist2(double x1, double y1, double x2, double y2) {
		return (int) (sqr(x2 - x1) + sqr(y2 - y1));
	}

	private double distToSegment(int x0, int y0, int x1, int y1, int x2, int y2) {
		double l2 = dist2(x1, y1, x2, y2);
		if (l2 == 0)
			return Math.sqrt(dist2(x0, y0, x1, y1));
		double t = ((x0 - x1) * (x2 - x1) + (y0 - y1) * (y2 - y1)) / l2;
		t = Math.max(0, Math.min(1, t));
		return Math.sqrt(dist2(x0, y0, x1 + t * (x2 - x1), y1 + t * (y2 - y1)));
	}
	
	public void mouseWheelMoved(MouseWheelEvent e) {

		Point2D p = null;
		try {
			p = tx.inverseTransform(e.getPoint(), null);
		} catch (NoninvertibleTransformException ex) {}

		d -= (0.1 * e.getWheelRotation());
		d = Math.max(0.1, d);

		tx.setToIdentity();
		tx.translate(e.getX(), e.getY());
		tx.scale(d, d);
		tx.translate(-p.getX(), -p.getY());

		this.repaint();
	}
	
	class MyMouseListener extends MouseAdapter {
		Graph graph;

		public MyMouseListener(Graph g) {
			graph = g;
		}

		public void mousePressed(MouseEvent e) {
			x1 = e.getX();
			y1 = e.getY();
		}

		public void mouseClicked(MouseEvent e) {
			if (e.getButton() == 2) {
				d = 1;
				tx = new AffineTransform();
				graph.repaint();
			}
		}
	}

	class MyMouseMotionListener extends MouseMotionAdapter {
		Graph graph;
		int x, y;

		public MyMouseMotionListener(Graph g) {
			graph = g;
		}

		public void mouseDragged(MouseEvent e) {
			if (SwingUtilities.isLeftMouseButton(e)) {
				x2 = e.getX();
				y2 = e.getY();
				tx.translate((x2 - x1) / d, (y2 - y1) / d);
				x1 = x2;
				y1 = y2;
				graph.repaint();
			}
		}
	}

	public void run() {
		try {
			while (true) {
				newColor[0] = Color.RED;
				newColor[1] = Color.GREEN;
				newColor[2] = Color.BLUE;
				repaint();
				Thread.sleep(500);

				for (int i = 0; i < 255; i += 25) {
					newColor[0] = new Color(255, i, i, 255);
					newColor[1] = new Color(i, 255, i, 255);
					newColor[2] = new Color(i, i, 255, 255);
					repaint();
					Thread.sleep(120);
				}
				do {
					Thread.sleep(300);
					readCoords();
					findNode(point[1], 1);
					findNode(point[2], 2);
					p = router.exectue(findNode(point[0], 0), 402, nodesIDs);
					
					if (p.length > 1) {
						repaint();
						break;
					}
					p = new int[] { 0 };
					repaint();
				} while (true);
			}
		} catch (InterruptedException ex) {}
	}
}
